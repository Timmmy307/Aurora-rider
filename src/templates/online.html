<!-- Aurora Rider Online Mode UI -->

<!-- Online Menu Container (appears when Online mode is selected) -->
<a-entity
  id="onlineMenu"
  bind__visible="onlineMenuActive"
  position="0 1.5 -1.5">

  <!-- Click blocker - invisible plane to block clicks behind menu -->
  <a-entity
    id="onlineMenuBlocker"
    bind-toggle__raycastable="onlineMenuActive"
    geometry="primitive: plane; width: 10; height: 10"
    material="shader: flat; color: #000; opacity: 0; transparent: true; side: double"
    position="0 0 -0.1"></a-entity>

  <!-- Background -->
  <a-entity
    geometry="primitive: plane; width: 2.4; height: 1.8"
    material="shader: flat; color: #000; opacity: 1"
    position="0 0 -0.01"></a-entity>

  <!-- Title -->
  <a-entity
    mixin="font"
    text="align: center; wrapCount: 25; value: AURORA RIDER ONLINE; width: 2; color: #FF6BE6"
    position="0 0.55 0.01"></a-entity>

  <!-- Main Panel - Create/Join (when not in room) -->
  <a-entity bind__visible="onlineShowMainPanel">
    
    <!-- Create Room Button -->
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineShowMainPanel"
      position="-0.35 0.2 0.01"
      proxy-event="event: click; to: a-scene; as: onlinecreatepanel"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 15; value: CREATE" position="0 -0.05 0.01"></a-entity>
    </a-entity>

    <!-- Join Room Button -->
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineShowMainPanel"
      position="0.35 0.2 0.01"
      proxy-event="event: click; to: a-scene; as: onlinejoinpanel"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 15; value: JOIN" position="0 -0.05 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Game Mode Selection (Create flow - Step 1) -->
  <a-entity bind__visible="onlineModeSelectPanelActive">
    <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 25; value: SELECT GAME MODE; width: 1.5" position="0 0.25 0.01"></a-entity>
    
    <!-- Classic Mode Button -->
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineModeSelectPanelActive"
      geometry="primitive: plane; width: 0.6; height: 0.35"
      position="-0.35 -0.05 0.01"
      proxy-event="event: click; to: a-scene; as: onlinecreateclassic"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #0FF; wrapCount: 12; value: CLASSIC; width: 0.5" position="0 0.02 0.01"></a-entity>
      <a-entity mixin="font" text="align: center; color: #888; wrapCount: 20; value: Sabers; width: 0.4" position="0 -0.08 0.01"></a-entity>
    </a-entity>

    <!-- Punch Mode Button -->
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineModeSelectPanelActive"
      geometry="primitive: plane; width: 0.6; height: 0.35"
      position="0.35 -0.05 0.01"
      proxy-event="event: click; to: a-scene; as: onlinecreatepunch"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FF6BE6; wrapCount: 12; value: PUNCH; width: 0.5" position="0 0.02 0.01"></a-entity>
      <a-entity mixin="font" text="align: center; color: #888; wrapCount: 20; value: Fists; width: 0.4" position="0 -0.08 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Username Entry (Create flow - Step 2) -->
  <a-entity bind__visible="onlineCreatePanelActive">
    <a-entity mixin="font" bind__text="value: onlineCreateModeDisplay" text="align: center; wrapCount: 20; width: 1; color: #FF6BE6" position="0 0.35 0.01"></a-entity>
    <a-entity
      id="createUsernameKeyboard"
      keyboard-raycastable="condition: onlineCreatePanelActive"
      bind__super-keyboard="hand: inVR && (activeHand === 'left' && '#leftHand' || '#rightHand') || '#mouseCursor'; show: onlineCreatePanelActive"
      super-keyboard="imagePath: assets/img/keyboard; font: assets/fonts/Viga-Regular.json; align: center; model: superkeyboard; keyColor: #fff; keyBgColor: #333; inputColor: #fff; labelColor: #FF6BE6; filters: allupper; maxLength: 10; width: 1.2; label: ENTER YOUR NAME; hand: #mouseCursor; injectToRaycasterObjects: false"
      proxy-event__accept="event: superkeyboardinput; to: a-scene; as: onlinecreateroom"
      position="0 0.05 0.02"></a-entity>
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineCreatePanelActive"
      position="0 -0.4 0.01"
      proxy-event="event: click; to: a-scene; as: onlinecreateroom"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 15; value: CREATE ROOM" position="0 -0.05 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Username Entry (Join flow) -->
  <a-entity bind__visible="onlineJoinPanelActive">
    <a-entity
      id="joinUsernameKeyboard"
      keyboard-raycastable="condition: onlineJoinPanelActive"
      bind__super-keyboard="hand: inVR && (activeHand === 'left' && '#leftHand' || '#rightHand') || '#mouseCursor'; show: onlineJoinPanelActive"
      super-keyboard="imagePath: assets/img/keyboard; font: assets/fonts/Viga-Regular.json; align: center; model: superkeyboard; keyColor: #fff; keyBgColor: #333; inputColor: #fff; labelColor: #FF6BE6; filters: allupper; maxLength: 10; width: 1.2; label: ENTER YOUR NAME; hand: #mouseCursor; injectToRaycasterObjects: false"
      proxy-event__accept="event: superkeyboardinput; to: a-scene; as: onlineshowjoincode"
      position="0 0.05 0.02"></a-entity>
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineJoinPanelActive"
      position="0 -0.4 0.01"
      proxy-event="event: click; to: a-scene; as: onlineshowjoincode"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 15; value: NEXT" position="0 -0.05 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Join Code Entry -->
  <a-entity bind__visible="onlineJoinCodePanelActive">
    <a-entity
      id="joinCodeKeyboard"
      keyboard-raycastable="condition: onlineJoinCodePanelActive"
      bind__super-keyboard="hand: inVR && (activeHand === 'left' && '#leftHand' || '#rightHand') || '#mouseCursor'; show: onlineJoinCodePanelActive"
      super-keyboard="imagePath: assets/img/keyboard; font: assets/fonts/Viga-Regular.json; align: center; model: superkeyboard; keyColor: #fff; keyBgColor: #333; inputColor: #fff; labelColor: #FF6BE6; filters: allupper; maxLength: 6; width: 1.2; label: ENTER ROOM CODE; hand: #mouseCursor; injectToRaycasterObjects: false"
      proxy-event__accept="event: superkeyboardinput; to: a-scene; as: onlinejoinroom"
      position="0 0.05 0.02"></a-entity>
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineJoinCodePanelActive"
      position="0 -0.4 0.01"
      proxy-event="event: click; to: a-scene; as: onlinejoinroom"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 15; value: JOIN ROOM" position="0 -0.05 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Lobby (waiting in room) -->
  <a-entity bind__visible="onlineInLobby">
    <a-entity mixin="font" bind__text="value: onlineRoomCode" text="align: center; wrapCount: 12; width: 2; color: #FF6BE6" position="0 0.42 0.01"></a-entity>
    <a-entity mixin="font" bind__text="value: onlineGameModeDisplay" text="align: center; wrapCount: 20; width: 1; color: #0FF" position="0 0.28 0.01"></a-entity>
    <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 25; value: PLAYERS:; width: 1.5" position="0 0.12 0.01"></a-entity>
    <a-entity mixin="font" bind__text="value: onlinePlayersText" text="align: center; wrapCount: 30; width: 1.5; lineHeight: 50; color: #0FF" position="0 -0.08 0.01"></a-entity>
    
    <!-- Host: Pick Song Button -->
    <a-entity bind__visible="onlineIsHost">
      <a-entity
        mixin="bigMenuButton"
        bind-toggle__raycastable="onlineIsHost && onlineInLobby"
        position="-0.35 -0.35 0.01"
        proxy-event="event: click; to: a-scene; as: onlineselectsong"
        play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
        <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 15; value: PICK SONG" position="0 -0.05 0.01"></a-entity>
      </a-entity>
    </a-entity>
    
    <!-- Non-host: Waiting message -->
    <a-entity bind__visible="!onlineIsHost">
      <a-entity mixin="font" text="align: center; color: #888; wrapCount: 35; value: Waiting for host to pick a song...; width: 1.5" position="0 -0.35 0.01"></a-entity>
    </a-entity>
    
    <!-- Leave Room Button (both host and non-host) -->
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineInLobby"
      bind__position="onlineIsHost && '0.35 -0.35 0.01' || '0 -0.55 0.01'"
      proxy-event="event: click; to: a-scene; as: onlineleaveroom"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #F44; wrapCount: 15; value: LEAVE" position="0 -0.05 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Countdown -->
  <a-entity bind__visible="onlineInCountdown">
    <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 25; value: GET READY!; width: 2" position="0 0.2 0.01"></a-entity>
    <a-entity mixin="font" bind__text="value: onlineCountdown" text="align: center; wrapCount: 5; width: 3; color: #FF6BE6" position="0 -0.1 0.01"></a-entity>
  </a-entity>

  <!-- Error display -->
  <a-entity bind__visible="onlineHasError" mixin="font" bind__text="value: onlineError" text="align: center; color: #F44; wrapCount: 40; width: 1.5" position="0 -0.55 0.01"></a-entity>

  <!-- Back Button -->
  <a-entity
    mixin="bigMenuButton"
    bind-toggle__raycastable="onlineMenuActive"
    bind__visible="!onlineInCountdown && !onlineInLobby && !onlineWaitingForPlayers"
    position="0 -0.7 0.01"
    proxy-event="event: click; to: a-scene; as: onlinemenuback"
    play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
    <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 10; value: BACK" position="0 -0.05 0.01"></a-entity>
  </a-entity>
</a-entity>

<!-- Online Waiting Screen (waiting for other players to finish) -->
<a-entity
  id="onlineWaiting"
  bind__visible="onlineWaitingForPlayers"
  position="0 1.5 -2">

  <a-entity
    geometry="primitive: plane; width: 2.2; height: 1.2"
    material="shader: flat; color: #111; opacity: 0.95"
    position="0 0 -0.01"></a-entity>

  <a-entity mixin="font" text="align: center; wrapCount: 20; value: SONG COMPLETE!; width: 2; color: #FF6BE6" position="0 0.35 0.01"></a-entity>
  
  <a-entity mixin="font" bind__text="value: onlineWaitingText" text="align: center; wrapCount: 40; width: 1.8; color: #0FF" position="0 0.05 0.01"></a-entity>
  
  <a-entity mixin="font" text="align: center; wrapCount: 50; value: Please wait for all players to finish...; width: 1.5; color: #888" position="0 -0.2 0.01"></a-entity>
  
  <!-- Animated dots -->
  <a-entity mixin="font" text="align: center; wrapCount: 10; value: . . .; width: 1; color: #FFF" position="0 -0.4 0.01"
    animation="property: text.opacity; from: 0.3; to: 1; dur: 500; loop: true; dir: alternate"></a-entity>
</a-entity>

<!-- Online Results Screen -->
<a-entity
  id="onlineResults"
  bind__visible="onlineInResults"
  position="0 1.5 -2">

  <a-entity
    geometry="primitive: plane; width: 2.2; height: 1.6"
    material="shader: flat; color: #111; opacity: 0.95"
    position="0 0 -0.01"></a-entity>

  <a-entity mixin="font" text="align: center; wrapCount: 20; value: FINAL SCORES; width: 2; color: #FF6BE6" position="0 0.6 0.01"></a-entity>

  <a-entity mixin="font" bind__text="value: onlineLeaderboardText" text="align: center; wrapCount: 40; width: 2; lineHeight: 55; color: #0FF" position="0 0.15 0.01"></a-entity>

  <!-- Host: Play Again -->
  <a-entity bind__visible="onlineIsHost">
    <a-entity
      mixin="bigMenuButton"
      bind-toggle__raycastable="onlineIsHost"
      position="-0.35 -0.5 0.01"
      proxy-event="event: click; to: a-scene; as: onlineplayagain"
      play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
      <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 12; value: PLAY AGAIN" position="0 -0.05 0.01"></a-entity>
    </a-entity>
  </a-entity>

  <!-- Leave Button -->
  <a-entity
    mixin="bigMenuButton"
    bind-toggle__raycastable="onlineInResults"
    position="0.35 -0.5 0.01"
    proxy-event="event: click; to: a-scene; as: onlineleaveroom"
    play-sound="event: mouseenter; sound: #hoverSound; volume: 0.03">
    <a-entity mixin="font" text="align: center; color: #FFF; wrapCount: 10; value: LEAVE" position="0 -0.05 0.01"></a-entity>
  </a-entity>

  <!-- Non-host waiting -->
  <a-entity bind__visible="!onlineIsHost" mixin="font" text="align: center; color: #888; wrapCount: 40; value: Waiting for host...; width: 1.5" position="0 -0.65 0.01"></a-entity>
</a-entity>
